const EV={};EV.convert={toHtml:function toHtml(string){return String(string).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},uint6ToB64:function uint6ToB64(nUint6){return nUint6<26?nUint6+65:nUint6<52?nUint6+71:nUint6<62?nUint6-4:nUint6===62?43:nUint6===63?47:65},base64EncArr:function base64EncArr(aBytes){var nMod3=2,sB64Enc="";for(var nLen=aBytes.length,nUint24=0,nIdx=0;nIdx<nLen;nIdx++){nMod3=nIdx%3;if(nIdx>0&&nIdx*4/3%76===0){sB64Enc+="\r\n"}nUint24|=aBytes[nIdx]<<(16>>>nMod3&24);if(nMod3===2||aBytes.length-nIdx===1){sB64Enc+=String.fromCodePoint(EV.convert.uint6ToB64(nUint24>>>18&63),EV.convert.uint6ToB64(nUint24>>>12&63),EV.convert.uint6ToB64(nUint24>>>6&63),EV.convert.uint6ToB64(nUint24&63));nUint24=0}}return sB64Enc.substr(0,sB64Enc.length-2+nMod3)+(nMod3===2?"":nMod3===1?"=":"==")},strToUTF8Arr:function strToUTF8Arr(sDOMStr){var aBytes,nChr,nStrLen=sDOMStr.length,nArrLen=0;for(var nMapIdx=0;nMapIdx<nStrLen;nMapIdx++){nChr=sDOMStr.codePointAt(nMapIdx);if(nChr>65536){nMapIdx++}nArrLen+=nChr<128?1:nChr<2048?2:nChr<65536?3:nChr<2097152?4:nChr<67108864?5:6}aBytes=new Uint8Array(nArrLen);for(var nIdx=0,nChrIdx=0;nIdx<nArrLen;nChrIdx++){nChr=sDOMStr.codePointAt(nChrIdx);if(nChr<128){aBytes[nIdx++]=nChr}else if(nChr<2048){aBytes[nIdx++]=192+(nChr>>>6);aBytes[nIdx++]=128+(nChr&63)}else if(nChr<65536){aBytes[nIdx++]=224+(nChr>>>12);aBytes[nIdx++]=128+(nChr>>>6&63);aBytes[nIdx++]=128+(nChr&63)}else if(nChr<2097152){aBytes[nIdx++]=240+(nChr>>>18);aBytes[nIdx++]=128+(nChr>>>12&63);aBytes[nIdx++]=128+(nChr>>>6&63);aBytes[nIdx++]=128+(nChr&63);nChrIdx++}else if(nChr<67108864){aBytes[nIdx++]=248+(nChr>>>24);aBytes[nIdx++]=128+(nChr>>>18&63);aBytes[nIdx++]=128+(nChr>>>12&63);aBytes[nIdx++]=128+(nChr>>>6&63);aBytes[nIdx++]=128+(nChr&63);nChrIdx++}else{aBytes[nIdx++]=252+(nChr>>>30);aBytes[nIdx++]=128+(nChr>>>24&63);aBytes[nIdx++]=128+(nChr>>>18&63);aBytes[nIdx++]=128+(nChr>>>12&63);aBytes[nIdx++]=128+(nChr>>>6&63);aBytes[nIdx++]=128+(nChr&63);nChrIdx++}}return aBytes},toBase64:function toBase64(string){return EV.convert.base64EncArr(EV.convert.strToUTF8Arr(string))},b64ToUint6:function b64ToUint6(nChr){return nChr>64&&nChr<91?nChr-65:nChr>96&&nChr<123?nChr-71:nChr>47&&nChr<58?nChr+4:nChr===43?62:nChr===47?63:0},base64DecToArr:function base64DecToArr(sBase64,nBlocksSize){var sB64Enc=sBase64.replace(/[^A-Za-z0-9\+\/]/g,""),nInLen=sB64Enc.length,nOutLen=nBlocksSize?Math.ceil((nInLen*3+1>>2)/nBlocksSize)*nBlocksSize:nInLen*3+1>>2,taBytes=new Uint8Array(nOutLen);for(var nMod3,nMod4,nUint24=0,nOutIdx=0,nInIdx=0;nInIdx<nInLen;nInIdx++){nMod4=nInIdx&3;nUint24|=EV.convert.b64ToUint6(sB64Enc.charCodeAt(nInIdx))<<6*(3-nMod4);if(nMod4===3||nInLen-nInIdx===1){for(nMod3=0;nMod3<3&&nOutIdx<nOutLen;nMod3++,nOutIdx++){taBytes[nOutIdx]=nUint24>>>(16>>>nMod3&24)&255}nUint24=0}}return taBytes},UTF8ArrToStr:function UTF8ArrToStr(aBytes){var sView="";for(var nPart,nLen=aBytes.length,nIdx=0;nIdx<nLen;nIdx++){nPart=aBytes[nIdx];sView+=String.fromCodePoint(nPart>251&&nPart<254&&nIdx+5<nLen?(nPart-252)*1073741824+(aBytes[++nIdx]-128<<24)+(aBytes[++nIdx]-128<<18)+(aBytes[++nIdx]-128<<12)+(aBytes[++nIdx]-128<<6)+aBytes[++nIdx]-128:nPart>247&&nPart<252&&nIdx+4<nLen?(nPart-248<<24)+(aBytes[++nIdx]-128<<18)+(aBytes[++nIdx]-128<<12)+(aBytes[++nIdx]-128<<6)+aBytes[++nIdx]-128:nPart>239&&nPart<248&&nIdx+3<nLen?(nPart-240<<18)+(aBytes[++nIdx]-128<<12)+(aBytes[++nIdx]-128<<6)+aBytes[++nIdx]-128:nPart>223&&nPart<240&&nIdx+2<nLen?(nPart-224<<12)+(aBytes[++nIdx]-128<<6)+aBytes[++nIdx]-128:nPart>191&&nPart<224&&nIdx+1<nLen?(nPart-192<<6)+aBytes[++nIdx]-128:nPart)}return sView},toString:function toString(base64){return EV.convert.UTF8ArrToStr(EV.convert.base64DecToArr(base64))}};EV.contract={address:"0x731d6C6eF47e62ae0e61f51fE21EC5a513d75C68",abi:[{inputs:[{internalType:"address",name:"_owner",type:"address"}],name:"walletOfOwner",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],obj:null,get:function getContract(){if(EV.contract.obj==null){if(!ethers.provider){ethers.provider=new ethers.providers.Web3Provider(window.ethereum,"any")}EV.contract.obj=new ethers.Contract(EV.contract.address,EV.contract.abi,ethers.provider)}return EV.contract.obj}};EV.proxy={shorten:function shorten(address){let short=`${address.slice(0,6)} ... ${address.slice(-4)}`;return short},getAddress:async function getAddress(callback){if(!ethers.provider){ethers.provider=new ethers.providers.Web3Provider(window.ethereum,"any")}await ethers.provider.send("eth_requestAccounts",[]).catch(error=>{console.error(error)}).then(accs=>{if(accs&&accs.length>0){callback(accs[0])}else{callback(null)}})},getTokens:async function getTokens(wallet,callback){let cont=EV.contract.get();let finished=false;setTimeout(function(){if(!finished){callback([])}},1e3);cont.walletOfOwner(wallet).catch(error=>{console.error(error);finished=true}).then(tokens=>{finished=true;callback(tokens.map(item=>{return ethers.BigNumber.from(item).toNumber()}))})},getURI:async function getURI(id,callback){let cont=EV.contract.get();await cont.tokenURI(id).then(uri=>{callback(uri)}).catch(error=>{console.error(error);callback(0)})},download:async function download(obj,name){var dataStr="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(obj));var downloadAnchorNode=document.createElement("a");downloadAnchorNode.setAttribute("href",dataStr);downloadAnchorNode.setAttribute("download",name+".json");document.body.appendChild(downloadAnchorNode);downloadAnchorNode.click();downloadAnchorNode.remove()},readLocal:async function readLocal(path,callback){var iframe=await document.getElementById("source");if(!iframe){iframe=document.createElement("iframe")}iframe.id="source";iframe.style.display="none";iframe.src=path;document.body.appendChild(iframe);iframe.contentWindow.document.body.onload=event=>{let content=event.target.body.children[0].innerText;if(content.indexOf("{")===-1){callback(null)}else{callback(JSON.parse(event.target.body.children[0].innerText))}}},read:async function read(url,callback,rule="*/*"){var xhr=new XMLHttpRequest;xhr.open("GET",url);xhr.setRequestHeader("Accept",rule);xhr.onreadystatechange=function(){if(xhr.readyState===4){callback(xhr)}else{callback(null)}};xhr.send()},sign:async function sign(message,callback=null){let current=null;if(!ethers.provider){ethers.provider=new ethers.providers.Web3Provider(window.ethereum,"any")}if(!ethers.signer){ethers.signer=await ethers.provider.getSigner()}current=ethers.signer;await current.signMessage(message).catch(error=>{console.log(error.message)}).then(response=>{if(callback){callback(response)}})},verify:async function verify(signed,reference,callback=null){let current=null;if(!ethers.provider){ethers.provider=new ethers.providers.Web3Provider(window.ethereum,"any")}if(!ethers.signer){ethers.signer=await ethers.provider.getSigner()}current=ethers.signer;const original=ethers.utils.verifyMessage(reference,signed);if(callback){callback(original)}return original}};EV.vector={make:function make(original=null){if(original){return{head:original.head,text:original.text,msg:original.msg,footer:original.footer}}else{return{head:"",text:"",msg:"",footer:""}}},toVector:function toVector(text){let newVector=EV.vector.make();let a=text.indexOf("<text");let b=text.slice(a).indexOf(">");newVector.head=text.substr(0,a);newVector.text=text.substr(a,b+1);let c=text.slice(a+b).indexOf("</text>");newVector.msg=text.substr(a+b+1,c-1);newVector.footer=text.substr(a+b+c);return newVector},splitMessage:function splitMessage(vector,fontSize=0){let msg=vector.message;let parts=msg.split("</tspan>");let split=[];if(parts.length<3){return split}for(let i=0;i<parts.length;i++){split[i]=parts[i].split(">")[1]}split.pop();if(fontSize>0){let a=parts[0].indexOf('y="');let b=parts[0].slice(a).indexOf('"');let off=parseFloat(parts[0].substr(a+3,b));let val=0;if(off>0){val=off-55+Math.ceil(1.2*fontSize)}else if(off<0){val=off-55+Math.floor(1.2*fontSize)}else{val=off-55+Math.round(1.2*fontSize)}split.push(val)}return split},getFontSize:function getFontSize(vector){let split=vector.text.split('font-size="');let a=split[0];let b=split[1].substr(0,split[1].indexOf('px"'));return b},toSVG:function toSVG(vector,M="",S="",G="",size=12,offset=0,removeStyle=false){let fs=parseFloat(size);if(isNaN(fs)){fs=0}let split=vector.text.split('font-size="');let a=split[0];let b=split[1].substr(split[1].indexOf('px"'));vector.text=a+'font-size="'+size.toString()+b;let to=parseFloat(offset);if(isNaN(to)){to=0}vector.msg=`<tspan x="50" y="${55-1.2*fs+to}">${M}</tspan><tspan x="50" y="${55+to}">${S}</tspan><tspan x="50" y="${55+1.2*fs+to}">${G}</tspan>`;if(removeStyle){let c=vector.footer.split("<style>")[0];let d=vector.footer.split("</style>")[1];return vector.head.toString()+vector.text.toString()+vector.msg.toString()+c+d}else{return vector.head.toString()+vector.text.toString()+vector.msg.toString()+vector.footer.toString()}}};
